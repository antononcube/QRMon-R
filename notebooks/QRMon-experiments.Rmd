---
title: "QRMon experiments"
author: "Anton Antonov"
date: "1/19/2019"
output: html_notebook
---

```{r}
library(magrittr)
library(ggplot2)
library(quantreg)
library(splines)
#library(QRMon)
devtools::load_all()
```


```{r}
source("../R/QRMon.R")
```

# Introduction

# Data

```{r}
data(airquality)
summary(airquality)
```

```{r}
library(MASS)
data(mcycle)
summary(mcycle)
```

# Main pipeline

## MASS dataset

```{r}
qrmon <-
  QRMonUnit( mcycle) %>%
  QRMonQuantileRegression( df = 12, degree = 3, quantiles = seq(0.2,0.8,0.2) ) %>% 
  QRMonPlot( dataPointsColor = "gray10", regressionCurvesColor = ~ RegressionCurve )
```


## Airquality dataset 

```{r}
data("airquality")
qrmon <-
  QRMonUnit( airquality[, c("Day", "Ozone")] ) %>%
  QRMonQuantileRegression( df = 12, degree = 3, quantiles = seq(0.2,0.8,0.2) ) %>% 
  QRMonPlot( dataPointsColor = "gray10", regressionCurvesColor = ~ RegressionCurve )
```
# Outliers

```{r}
qrmon <-
  qrmon %>% 
  QRMonSetRegressionObjects(NULL) %>% 
  QRMonQuantileRegression( df = 12, quantiles = c(0.05, 0.95) ) %>% 
  QRMonOutliers() %>% 
  QRMonOutliersPlot( plotRegressionCurvesQ = TRUE )
```

# Simulate

```{r}
qrmon <- qrmon %>% QRMonSimulate(100)
ggplot( qrmon %>% QRMonTakeValue() ) +
  geom_point( aes( x = Time, y = Value ), color = "blue" )
```

